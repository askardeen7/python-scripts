import boto3

# Initialize EC2 client
ec2 = boto3.client('ec2')

def cleanup_unused_volumes():
    """Find and delete unattached (available) EBS volumes."""
    print("ğŸ” Checking for unused (unattached) EBS volumes...")

    # Filter volumes that are in 'available' state (not attached)
    response = ec2.describe_volumes(Filters=[{'Name': 'status', 'Values': ['available']}])
    volumes = response['Volumes']

    if not volumes:
        print("âœ… No unused volumes found.")
        return

    for vol in volumes:
        vol_id = vol['VolumeId']
        size = vol['Size']
        az = vol['AvailabilityZone']
        create_time = vol['CreateTime']

        print(f"ğŸ—‘ï¸ Deleting unused volume: {vol_id} | Size: {size}GB | AZ: {az} | Created: {create_time}")

        try:
            ec2.delete_volume(VolumeId=vol_id)
            print(f"âœ… Successfully deleted volume {vol_id}")
        except Exception as e:
            print(f"âŒ Error deleting volume {vol_id}: {e}")

def main():
    print("==== AWS Unattached EBS Volume Cleanup Started ====")
    cleanup_unused_volumes()
    print("==== Cleanup Completed ====")

if __name__ == "__main__":
    main()
